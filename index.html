<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Tournament Bracket Tool</title>
        <style>
            :root {
                --bg: #0b0f1a;
                --panel: #12172a;
                --neon: #00fff6;
                --neon-soft: rgba(0, 255, 246, 0.4);
                --danger: #ff3864;
                --text: #e6f1ff;
            }

            body {
                margin: 0;
                background: radial-gradient(circle at top, #101633, var(--bg));
                color: var(--text);
                font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
                padding: 1.5rem;
            }

            .app {
                max-width: 600px;
                margin: 2rem auto 3rem auto;
            }

            h1 {
                text-align: center;
                color: var(--neon);
                text-shadow: 0 0 12px var(--neon-soft);
                margin-bottom: 1rem;
            }

            .controls {
                display: flex;
                flex-wrap: wrap;
                gap: 0.75rem;
                margin-bottom: 1rem;
                background: var(--panel);
                padding: 1rem;
                border-radius: 10px;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
            }

            textarea,
            input[type="number"] {
                padding: 0.6rem;
                border: 1px solid var(--neon-soft);
                border-radius: 6px;
                background: #0e1325;
                color: var(--text);
                width: 100%;
                box-sizing: border-box;
            }

            textarea::placeholder {
                color: #6ee7e0;
                opacity: 0.7;
            }

            textarea:focus,
            input:focus {
                outline: none;
                border-color: var(--neon);
                box-shadow: 0 0 8px var(--neon-soft);
            }

            textarea {
                resize: vertical;
            }

            button {
                background: linear-gradient(135deg, #00c6ff, #00fff6);
                color: #002b2a;
                border: none;
                padding: 0.9rem 1rem;
                cursor: pointer;
                border-radius: 8px;
                width: 100%;
                font-weight: 600;
                letter-spacing: 0.5px;
                box-shadow: 0 0 12px var(--neon-soft);
            }

            button:hover:not(:disabled) {
                filter: brightness(1.1);
            }

            button:disabled {
                background: #333;
                color: #777;
                box-shadow: none;
                cursor: not-allowed;
            }

            .players {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
                margin: 1rem 0;
            }

            .player {
                background: #0e1325;
                padding: 0.4rem 0.6rem;
                border-radius: 999px;
                display: flex;
                align-items: center;
                gap: 0.4rem;
                border: 1px solid var(--neon-soft);
                box-shadow: 0 0 6px rgba(0, 255, 246, 0.15);
            }

            .player button {
                background: none;
                border: none;
                color: var(--danger);
                cursor: pointer;
                font-size: 0.9rem;
                line-height: 1;
                padding: 0;
                width: 1.25rem;
                height: 1.25rem;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
            }

            .player button:hover {
                background: rgba(255, 56, 100, 0.15);
            }

            .round {
                margin-top: 1.5rem;
                background: var(--panel);
                padding: 1rem;
                border-radius: 10px;
                border: 1px solid var(--neon-soft);
                box-shadow: 0 0 16px rgba(0, 0, 0, 0.6);
            }

            .round h2 {
                margin-top: 0;
                color: var(--neon);
                text-shadow: 0 0 8px var(--neon-soft);
            }

            label {
                font-size: 0.75rem;
                text-transform: uppercase;
                letter-spacing: 0.08em;
                opacity: 0.8;
            }

            .half {
                flex: 1 1 48%;
                display: flex;
                flex-direction: column;
            }
        </style>
    </head>
    <body>
        <div class="app">
            <h1>Tournament Bracket Tool</h1>

            <div class="controls">
                <div style="width: 100%">
                    <label>Player names (one per line, up to 64)</label>
                    <textarea
                        id="playerInput"
                        rows="4"
                        placeholder="Alice
Bob
Charlie"></textarea>
                </div>

                <button id="addPlayersBtn">Add Players</button>

                <div class="half">
                    <label>Tables</label>
                    <input type="number" id="tablesInput" min="1" max="8" value="5" />
                </div>
                <div class="half">
                    <label>Rounds</label>
                    <input type="number" id="roundsInput" min="1" max="3" value="3" />
                </div>
            </div>

            <div class="players" id="players"></div>

            <button id="startBtn" disabled>Start Tournament</button>

            <div id="schedule"></div>
        </div>

        <script>
            const maxPlayers = 64;
            let players = [];

            const playerInput = document.getElementById("playerInput");
            const addPlayersBtn = document.getElementById("addPlayersBtn");
            const playersDiv = document.getElementById("players");
            const tablesInput = document.getElementById("tablesInput");
            const roundsInput = document.getElementById("roundsInput");
            const startBtn = document.getElementById("startBtn");
            const scheduleDiv = document.getElementById("schedule");

            addPlayersBtn.addEventListener("click", addPlayers);
            startBtn.addEventListener("click", startTournament);

            function addPlayers() {
                const raw = playerInput.value.trim();
                if (!raw) return;

                const names = raw
                    .split(/\r?\n/)
                    .map((n) => n.trim())
                    .filter(Boolean);
                for (const name of names) {
                    if (players.length >= maxPlayers) break;
                    if (!players.includes(name)) players.push(name);
                }

                playerInput.value = "";
                renderPlayers();
            }

            function renderPlayers() {
                playersDiv.innerHTML = "";
                players.forEach((p, index) => {
                    const div = document.createElement("div");
                    div.className = "player";

                    const nameSpan = document.createElement("span");
                    nameSpan.textContent = p;

                    const removeBtn = document.createElement("button");
                    removeBtn.textContent = "Ã—";
                    removeBtn.title = "Remove player";
                    removeBtn.addEventListener("click", () => {
                        players.splice(index, 1);
                        renderPlayers();
                    });

                    div.appendChild(nameSpan);
                    div.appendChild(removeBtn);
                    playersDiv.appendChild(div);
                });
                startBtn.disabled = players.length < 2;
            }

            function generateSchedule(players, tables, rounds) {
                const schedule = [];
                const playedPairs = new Set();

                for (let r = 0; r < rounds; r++) {
                    const available = [...players];
                    const matches = [];

                    while (available.length > 1) {
                        const p1 = available.shift();
                        let found = false;

                        for (let i = 0; i < available.length; i++) {
                            const p2 = available[i];
                            const key = [p1, p2].sort().join("-");
                            if (!playedPairs.has(key)) {
                                matches.push({ player1: p1, player2: p2, table: (matches.length % tables) + 1 });
                                playedPairs.add(key);
                                available.splice(i, 1);
                                found = true;
                                break;
                            }
                        }

                        if (!found) {
                            const p2 = available.pop();
                            matches.push({ player1: p1, player2: p2 || null, table: -1 });
                        }
                    }

                    if (available.length === 1) {
                        matches.push({ player1: available[0], player2: null, table: -1 });
                    }

                    schedule.push({ round: r + 1, matches });
                }
                return schedule;
            }

            function startTournament() {
                const tables = parseInt(tablesInput.value, 10);
                const rounds = parseInt(roundsInput.value, 10);
                renderSchedule(generateSchedule(players, tables, rounds));
            }

            function renderSchedule(schedule) {
                scheduleDiv.innerHTML = "";
                schedule.forEach((round) => {
                    const div = document.createElement("div");
                    div.className = "round";
                    div.innerHTML = `<h2>Round ${round.round}</h2>`;
                    const ul = document.createElement("ul");
                    round.matches.forEach((m) => {
                        const li = document.createElement("li");
                        li.textContent = `${m.player1} vs ${m.player2 || "Bye"}${m.table !== -1 ? " - Table " + m.table : ""}`;
                        ul.appendChild(li);
                    });
                    div.appendChild(ul);
                    scheduleDiv.appendChild(div);
                });
            }
        </script>
    </body>
</html>
